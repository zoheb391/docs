<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/docs/blog/rss.xml" title="polkadot{.js} Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs/blog/atom.xml" title="polkadot{.js} Blog Atom Feed"><title data-react-helmet="true">Query subscriptions | polkadot{.js}</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Query subscriptions | polkadot{.js}"><meta data-react-helmet="true" name="description" content="Previously we explained the concepts between api.query. In this section we will expand on that knowledge to introduce subscriptions (akin to what we found in api.rpc) to stream results from the state, as it changes between blocks."><meta data-react-helmet="true" property="og:description" content="Previously we explained the concepts between api.query. In this section we will expand on that knowledge to introduce subscriptions (akin to what we found in api.rpc) to stream results from the state, as it changes between blocks."><meta data-react-helmet="true" property="og:url" content="https://polkadot.js.org/docs/api/start/api.query.subs"><link data-react-helmet="true" rel="shortcut icon" href="/docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://polkadot.js.org/docs/api/start/api.query.subs"><link rel="stylesheet" href="/docs/styles.948ce390.css">
<link rel="preload" href="/docs/styles.c88912d1.js" as="script">
<link rel="preload" href="/docs/runtime~main.c020b947.js" as="script">
<link rel="preload" href="/docs/main.53ef5267.js" as="script">
<link rel="preload" href="/docs/1.597c9a47.js" as="script">
<link rel="preload" href="/docs/2.f4e577f5.js" as="script">
<link rel="preload" href="/docs/111.c67e261e.js" as="script">
<link rel="preload" href="/docs/935f2afb.90384be2.js" as="script">
<link rel="preload" href="/docs/17896441.c26a6f83.js" as="script">
<link rel="preload" href="/docs/f336b2cf.503863ed.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/docs/"><img src="/docs/img/logo.svg" alt="polkadot{.js}" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/docs/img/logo.svg" alt="polkadot{.js}" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">polkadot{.js}</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://polkadot.js.org/apps/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Apps UI (Wallet)</a><a href="https://github.com/polkadot-js/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/docs/"><img src="/docs/img/logo.svg" alt="polkadot{.js}" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/docs/img/logo.svg" alt="polkadot{.js}" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">polkadot{.js}</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://polkadot.js.org/apps/" target="_blank" rel="noopener noreferrer" class="menu__link">Apps UI (Wallet)</a></li><li class="menu__list-item"><a href="https://github.com/polkadot-js/docs" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">Overview</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api">Overview</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/basics">Basics &amp; Metadata</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/create">Create an instance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/api.consts">Runtime constants</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/api.query">State queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/api.rpc">RPC queries</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/api/start/api.query.subs">Query subscriptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/api.query.multi">Multi queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/api.query.other">Query extras</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/api.tx">Transactions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/keyring">Keyring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/api.tx.subs">Transaction subscriptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/api.tx.wrap">Complex transactions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/types.basics">Type basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/types.extend">Extending types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/rpc.custom">rpc.custom</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/types.create">Type creation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/typescript">TypeScript interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/start/typescript.user">TypeScript user generated</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Cookbook</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/cookbook">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/cookbook/blocks">Blocks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/cookbook/storage">Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/cookbook/tx">Transactions</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise">ApiPromise Examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/simple-connect">Simple Connect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/listen-to-blocks">Listen to new blocks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/listen-to-balance-change">Listen to balance changes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/unsubscribe">Unsubscribe from listening to updates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/read-storage">Read storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/read-storage-at">Read storage, at a specific blockhash</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/make-transfer">Make a simple transfer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/system-events">Traverse events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/transfer-events">Transfer events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/upgrade-chain">Chain upgrade</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/typegen">TS type generation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/examples/promise/chain-info">Get chain information</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/FAQ">FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Substrate Metadata</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/rpc">JSON-RPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/constants">Constants</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/storage">Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/extrinsics">Extrinsics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/events">Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/substrate/errors">Errors</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Keyring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/create">Create</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/ss58">ss58 Formats</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/sign-verify">Sign &amp; Verify</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/start/suri">Substrate Uri</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/keyring/FAQ">FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Crypto Utilities</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples/create-mnemonic">Create Mnemonic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples/validate-address">Validate Address</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples/encrypt-decrypt">Encrypt &amp; Decrypt Messages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples/create-multisig">Generate a Multisig Account</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples/verify-signature">Verify Signature</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/examples/hash-data">Hash Data</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/util-crypto/FAQ">FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contracts (API)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start/basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start/code">Code</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start/blueprint">Blueprint</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start/contract.read">Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/start/contract.tx">Contract Tx</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-contract/FAQ">FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Identicon (UI)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-identicon">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-identicon/react">React</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-identicon/react-native">React Native</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-identicon/vue">Vue</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Keyring (UI)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start/init">Initialization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start/accounts">Accounts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start/addresses">Addresses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ui-keyring/start/loading">Loading saved pairs</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Extension</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extension">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extension/usage">Usage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extension/cookbook">Cookbook</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extension/FAQ">FAQ</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Query subscriptions</h1></header><div class="markdown"><p>Previously we explained the concepts between <code>api.query</code>. In this section we will expand on that knowledge to introduce subscriptions (akin to what we found in <code>api.rpc</code>) to stream results from the state, as it changes between blocks.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="subscriptions"></a>Subscriptions<a class="hash-link" href="#subscriptions" title="Direct link to heading">#</a></h2><p>As in the case with <code>api.rpc</code> subscriptions, query subscriptions follow exactly the same form - an actual call is augmented with a callback to return the current state value that is updated as the underlying value changes. As an example, we can extend on what we had previously -</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Retrieve the current timestamp via subscription</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> unsub </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">timestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">now</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">moment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token template-string string" style="color:rgb(195, 232, 141)">The last block has a timestamp of </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation">moment</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The form is exactly the same as the subscriptions we have seen previously, instead of the <code>await</code> returning the actual once-off value, it returns a subscription <code>unsub()</code> function that can be used to stop the subscription and clear up any underlying RPC connections. The supplied callback will contain the value as it changes, streamed from the node.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="subscriptions-with-params"></a>Subscriptions with params<a class="hash-link" href="#subscriptions-with-params" title="Direct link to heading">#</a></h2><p>If we had a query with parameters, i.e. where we wish to perform a query for a specific account, the form is exactly the same - the last parameter contains the actual callback, after all other parameters. To retrieve the balances for an account as it changes, we could do the following -</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Subscribe to balance changes for our account</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> unsub </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">system</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token constant" style="color:rgb(130, 170, 255)">ADDR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> nonce</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> data</span><span class="token parameter operator" style="color:rgb(137, 221, 255)">:</span><span class="token parameter"> balance </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token template-string string" style="color:rgb(195, 232, 141)">free balance is </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation">balance</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token template-string interpolation">free</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string string" style="color:rgb(195, 232, 141)"> with </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation">balance</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token template-string interpolation">reserved</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string string" style="color:rgb(195, 232, 141)"> reserved and a nonce of </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation">nonce</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>By now this subscription form should be familiar to you, including the usage of <code>unsub</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="multiple-queries"></a>Multiple queries<a class="hash-link" href="#multiple-queries" title="Direct link to heading">#</a></h2><p>In most non-trivial applications, it is useful to optimize both our code in terms of callbacks as well as node resources, for instance by <a href="/docs/api/start/api.query.multi">performing multiple queries at once, over the same RPC call</a>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/polkadot-js/docs/edit/master/docs/api/start/api.query.subs.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/api/start/api.rpc"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« RPC queries</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/api/start/api.query.multi"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Multi queries Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#subscriptions" class="table-of-contents__link">Subscriptions</a></li><li><a href="#subscriptions-with-params" class="table-of-contents__link">Subscriptions with params</a></li><li><a href="#multiple-queries" class="table-of-contents__link">Multiple queries</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/docs/styles.c88912d1.js"></script>
<script src="/docs/runtime~main.c020b947.js"></script>
<script src="/docs/main.53ef5267.js"></script>
<script src="/docs/1.597c9a47.js"></script>
<script src="/docs/2.f4e577f5.js"></script>
<script src="/docs/111.c67e261e.js"></script>
<script src="/docs/935f2afb.90384be2.js"></script>
<script src="/docs/17896441.c26a6f83.js"></script>
<script src="/docs/f336b2cf.503863ed.js"></script>
</body>
</html>